<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แดชบอร์ดข้อมูล EII</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        purple: {
                            400: '#a78bfa',
                            500: '#8b5cf6',
                            600: '#7c3aed',
                            700: '#6d28d9',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Noto Sans Thai', sans-serif;
        }

        .glow {
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.5);
        }

        .gradient-bg {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
        }

        /* CSS สำหรับทำให้เห็น calendar icon ใน Dark mode */
        input[type="date"] {
            background-color: #1f2937;
            border: 1px solid #374151;
            color: white;
            padding: 0.75rem;
            border-radius: 0.375rem;
        }

        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
            padding: 4px;
        }

        /* สำหรับ Firefox */
        @supports (-moz-appearance:none) {
            input[type="date"] {
                color-scheme: dark;
            }
        }

        /* ทำให้ข้อความใน input date มองเห็นชัด */
        input[type="date"]::-webkit-datetime-edit {
            color: white;
        }

        input[type="date"]::-webkit-datetime-edit-fields-wrapper {
            color: white;
        }

        input[type="date"]::-webkit-datetime-edit-text {
            color: #d1d5db;
        }
    </style>
</head>

<body class="gradient-bg min-h-screen text-white p-6">
    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-purple-400 mb-2">แดชบอร์ดข้อมูล EII</h1>
            <p class="text-gray-400">การแสดงผลข้อมูล EII รายเดือนด้วย HTML Canvas</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- ฟอร์มเดิม - แก้ไขแล้ว -->
            <div class="bg-gray-800 shadow-xl rounded-xl p-6 md:p-10 border border-purple-700 glow">
                <h2 class="text-3xl font-extrabold text-purple-400 mb-4">
                    ส่วนควบคุม 1: บันทึกข้อมูล EII รายเดือน
                </h2>
                <p class="text-gray-400 mb-6">
                    ป้อนวันที่และค่า EII แยกส่วน (HD, PP12, PP3) เพื่อจำลองการส่งข้อมูลในรูปแบบ `FormData` ไปยัง Google
                    Apps Script API.
                </p>

                <form id="eiiInputForm" class="space-y-6">
                    <!-- Date Input - แก้ไขแล้ว ไม่มี pointer-events-none และ readonly -->
                    <div>
                        <label for="inputDate" class="block text-sm font-medium text-gray-300 mb-1">
                            วันที่ (DateString - YYYY-MM-DD):
                        </label>
                        <input type="date" id="inputDate" name="DateString"
                            class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md text-gray-100 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>

                    <!-- EII Component Inputs -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- HD -->
                        <div>
                            <label for="inputHD" class="block text-sm font-medium text-gray-300 mb-1">HD (%)</label>
                            <input type="text" id="inputHD" name="HD" placeholder="0.00 to 100.00"
                                pattern="^([0-9]{1,2}\.[0-9]{2}|100\.00|[0-9]{1,3})$" oninput="validateEIIValue(this)"
                                class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md text-gray-100 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <!-- PP12 -->
                        <div>
                            <label for="inputPP12" class="block text-sm font-medium text-gray-300 mb-1">PP12 (%)</label>
                            <input type="text" id="inputPP12" name="PP12" placeholder="0.00 to 100.00"
                                pattern="^([0-9]{1,2}\.[0-9]{2}|100\.00|[0-9]{1,3})$" oninput="validateEIIValue(this)"
                                class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md text-gray-100 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <!-- PP3 -->
                        <div>
                            <label for="inputPP3" class="block text-sm font-medium text-gray-300 mb-1">PP3 (%)</label>
                            <input type="text" id="inputPP3" name="PP3" placeholder="0.00 to 100.00"
                                pattern="^([0-9]{1,2}\.[0-9]{2}|100\.00|[0-9]{1,3})$" oninput="validateEIIValue(this)"
                                class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md text-gray-100 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                    </div>

                    <!-- Custom Input Field with Pattern -->
                    <div>
                        <label for="customInput" class="block text-sm font-medium text-gray-300 mb-1">
                            Custom Input (Pattern: Alphanumeric):
                        </label>
                        <input type="text" id="customInput" name="customInput"
                            pattern="^([0-9]{1,2}\.[0-9]{2}|100\.00|[0-9]{1,3})$"
                            placeholder="Enter alphanumeric characters only"
                            title="กรุณาป้อนตัวเลขในรูปแบบ xx.xx หรือ xxx (เช่น 85.50 หรือ 100)"
                            oninput="validateEIIValue(this)"
                            class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md text-gray-100 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>

                    <!-- Target (Fixed value for API consistency) -->
                    <input type="hidden" name="Target" value="73.07">

                    <button type="submit"
                        class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-purple-500 focus:ring-opacity-50">
                        ส่งข้อมูล EII ไปยัง API (Console Log Demo)
                    </button>
                </form>
            </div>

            <!-- Canvas Visualization -->
            <div class="bg-gray-800 shadow-xl rounded-xl p-6 md:p-10 border border-purple-700 glow">
                <h2 class="text-3xl font-extrabold text-purple-400 mb-4">
                    การแสดงผลข้อมูล EII
                </h2>
                <p class="text-gray-400 mb-6">
                    การแสดงผลข้อมูล EII ด้วย HTML Canvas ในรูปแบบกราฟแท่งและวงกลม
                </p>

                <div class="space-y-8">
                    <!-- Bar Chart Canvas -->
                    <div>
                        <h3 class="text-xl font-bold text-purple-300 mb-4">กราฟแท่ง EII Components</h3>
                        <div class="bg-gray-900 rounded-lg p-4">
                            <canvas id="barChart" width="600" height="300" class="w-full h-auto"></canvas>
                        </div>
                    </div>

                    <!-- Pie Chart Canvas -->
                    <div>
                        <h3 class="text-xl font-bold text-purple-300 mb-4">สัดส่วน EII Components</h3>
                        <div class="bg-gray-900 rounded-lg p-4 flex justify-center">
                            <canvas id="pieChart" width="300" height="300" class="w-64 h-64"></canvas>
                        </div>
                    </div>

                    <!-- Line Chart Canvas -->
                    <div>
                        <h3 class="text-xl font-bold text-purple-300 mb-4">แนวโน้ม EII</h3>
                        <div class="bg-gray-900 rounded-lg p-4">
                            <canvas id="lineChart" width="600" height="300" class="w-full h-auto"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ฟังก์ชันวาดกราฟแท่ง
        function drawBarChart() {
            const canvas = document.getElementById('barChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // ข้อมูลตัวอย่าง
            const data = {
                labels: ['HD', 'PP12', 'PP3', 'Target'],
                values: [65, 72, 58, 73.07],
                colors: ['#8b5cf6', '#ec4899', '#10b981', '#f59e0b']
            };

            // ล้าง Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // พื้นหลัง
            ctx.fillStyle = '#1f2937';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ตั้งค่ากราฟ
            const margin = { top: 40, right: 20, bottom: 50, left: 60 };
            const chartWidth = canvas.width - margin.left - margin.right;
            const chartHeight = canvas.height - margin.top - margin.bottom;
            const barWidth = (chartWidth / data.labels.length) * 0.7;
            const maxValue = Math.max(...data.values) * 1.1;

            // วาดแกน
            ctx.strokeStyle = '#4b5563';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left, margin.top + chartHeight);
            ctx.lineTo(margin.left + chartWidth, margin.top + chartHeight);
            ctx.stroke();

            // วาดแท่ง
            data.labels.forEach((label, index) => {
                const barHeight = (data.values[index] / maxValue) * chartHeight;
                const x = margin.left + (index * (chartWidth / data.labels.length)) + (barWidth / 3);
                const y = margin.top + chartHeight - barHeight;

                // แท่งกราฟ
                ctx.fillStyle = data.colors[index];
                ctx.fillRect(x, y, barWidth, barHeight);

                // เพิ่มเงา
                ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                ctx.shadowBlur = 5;
                ctx.shadowOffsetX = 2;
                ctx.shadowOffsetY = 2;
                ctx.fillRect(x, y, barWidth, barHeight);
                ctx.shadowColor = 'transparent';

                // ข้อความค่า
                ctx.fillStyle = '#f3f4f6';
                ctx.font = '12px Noto Sans Thai';
                ctx.textAlign = 'center';
                ctx.fillText(data.values[index].toFixed(2), x + barWidth / 2, y - 5);

                // ป้ายชื่อ
                ctx.fillStyle = '#9ca3af';
                ctx.fillText(label, x + barWidth / 2, margin.top + chartHeight + 20);
            });

            // วาดเส้นเป้าหมาย
            ctx.strokeStyle = '#f59e0b';
            ctx.setLineDash([5, 5]);
            ctx.lineWidth = 2;
            const targetY = margin.top + chartHeight - (73.07 / maxValue) * chartHeight;
            ctx.beginPath();
            ctx.moveTo(margin.left, targetY);
            ctx.lineTo(margin.left + chartWidth, targetY);
            ctx.stroke();
            ctx.setLineDash([]);

            // ข้อความเส้นเป้าหมาย
            ctx.fillStyle = '#f59e0b';
            ctx.font = '12px Noto Sans Thai';
            ctx.textAlign = 'left';
            ctx.fillText('Target: 73.07%', margin.left + 10, targetY - 10);

            // ชื่อกราฟ
            ctx.fillStyle = '#e5e7eb';
            ctx.font = 'bold 16px Noto Sans Thai';
            ctx.textAlign = 'center';
            ctx.fillText('กราฟแท่งแสดงค่า EII Components', canvas.width / 2, 20);
        }

        // ฟังก์ชันวาดกราฟวงกลม


        // ฟังก์ชันวาดกราฟวงกลม
        // ฟังก์ชันวาดกราฟวงกลม
        function drawPieChart() {
            const canvas = document.getElementById('pieChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // ข้อมูลตัวอย่าง
            const data = {
                labels: ['HD', 'PP12', 'PP3'],
                values: [65, 72, 58],
                colors: ['#8b5cf6', '#ec4899', '#10b981']
            };

            // ล้าง Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // คำนวณค่าทั้งหมด
            const total = data.values.reduce((sum, value) => sum + value, 0);

            // ตั้งค่ากราฟ
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) * 0.8;

            let startAngle = 0;

            // วาดส่วนของวงกลม
            data.values.forEach((value, index) => {
                const sliceAngle = (value / total) * 2 * Math.PI;

                // วาดส่วนวงกลม
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, startAngle + sliceAngle);
                ctx.closePath();

                ctx.fillStyle = data.colors[index];
                ctx.fill();

                // เพิ่มเงา
                ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetX = 3;
                ctx.shadowOffsetY = 3;
                ctx.fill();
                ctx.shadowColor = 'transparent';

                // วาดเส้นขอบ
                ctx.strokeStyle = '#1f2937';
                ctx.lineWidth = 2;
                ctx.stroke();

                // คำนวณตำแหน่งข้อความ
                const labelAngle = startAngle + sliceAngle / 2;

                // สำหรับ PP12 ให้ปรับตำแหน่งพิเศษ
                if (data.labels[index] === 'PP12') {
                    // ตำแหน่ง label (ชื่อ) PP12
                    const labelX = centerX + (radius * 0.7) * Math.cos(labelAngle);
                    const labelY = centerY + (radius * 0.7) * Math.sin(labelAngle);

                    // ตำแหน่ง percentage อยู่ใต้ชื่อ PP12
                    const percentX = labelX; // X เดียวกันเพื่อให้อยู่ใต้กันตรงๆ
                    const percentY = labelY + 20; // ขยับลงมา 20px จากชื่อ

                    // วาด label (ชื่อ)
                    ctx.fillStyle = '#f3f4f6';
                    ctx.font = 'bold 14px Noto Sans Thai';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(data.labels[index], labelX, labelY);

                    // วาด percentage (ค่าเปอร์เซ็นต์)
                    ctx.fillStyle = '#d1d5db';
                    ctx.font = '12px Noto Sans Thai';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(`${((value / total) * 100).toFixed(1)}%`, percentX, percentY);
                } else {
                    // สำหรับ HD และ PP3 ใช้ตำแหน่งปกติ
                    const labelRadius = radius * 0.7;
                    const percentRadius = radius * 0.5;

                    const labelX = centerX + labelRadius * Math.cos(labelAngle);
                    const labelY = centerY + labelRadius * Math.sin(labelAngle);

                    const percentX = centerX + percentRadius * Math.cos(labelAngle);
                    const percentY = centerY + percentRadius * Math.sin(labelAngle);

                    // วาด label (ชื่อ)
                    ctx.fillStyle = '#f3f4f6';
                    ctx.font = 'bold 14px Noto Sans Thai';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(data.labels[index], labelX, labelY);

                    // วาด percentage (ค่าเปอร์เซ็นต์)
                    ctx.fillStyle = '#d1d5db';
                    ctx.font = '12px Noto Sans Thai';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(`${((value / total) * 100).toFixed(1)}%`, percentX, percentY);
                }

                startAngle += sliceAngle;
            });

            // วาดวงกลมกลาง
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius * 0.3, 0, 2 * Math.PI);
            ctx.fillStyle = '#1f2937';
            ctx.fill();

            // ข้อความกลาง
            ctx.fillStyle = '#e5e7eb';
            ctx.font = 'bold 16px Noto Sans Thai';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('EII', centerX, centerY);
        }

        // ฟังก์ชันวาดกราฟเส้น
        function drawLineChart() {
            const canvas = document.getElementById('lineChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // ข้อมูลตัวอย่าง
            const data = {
                labels: ['ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.'],
                values: [65, 68, 70, 72, 71, 73],
                target: 73.07
            };

            // ล้าง Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // พื้นหลัง
            ctx.fillStyle = '#1f2937';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ตั้งค่ากราฟ
            const margin = { top: 40, right: 20, bottom: 50, left: 60 };
            const chartWidth = canvas.width - margin.left - margin.right;
            const chartHeight = canvas.height - margin.top - margin.bottom;
            const maxValue = Math.max(...data.values, data.target) * 1.1;

            // วาดเส้นกริด
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 1;
            const gridLines = 5;

            for (let i = 0; i <= gridLines; i++) {
                const y = margin.top + (i * chartHeight / gridLines);
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + chartWidth, y);
                ctx.stroke();

                // ค่าแกน Y
                ctx.fillStyle = '#9ca3af';
                ctx.font = '12px Noto Sans Thai';
                ctx.textAlign = 'right';
                ctx.fillText(Math.round(maxValue - (i * maxValue / gridLines)), margin.left - 10, y + 4);
            }

            // วาดเส้นกราฟ
            ctx.beginPath();
            ctx.strokeStyle = '#8b5cf6';
            ctx.lineWidth = 3;
            ctx.lineJoin = 'round';

            data.values.forEach((value, index) => {
                const x = margin.left + (index * (chartWidth / (data.labels.length - 1)));
                const y = margin.top + chartHeight - (value / maxValue) * chartHeight;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });

            ctx.stroke();

            // วาดจุดข้อมูล
            data.values.forEach((value, index) => {
                const x = margin.left + (index * (chartWidth / (data.labels.length - 1)));
                const y = margin.top + chartHeight - (value / maxValue) * chartHeight;

                // จุดข้อมูล
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, 2 * Math.PI);
                ctx.fillStyle = '#8b5cf6';
                ctx.fill();

                // วงกลมรอบจุด
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, 2 * Math.PI);
                ctx.strokeStyle = '#8b5cf6';
                ctx.lineWidth = 2;
                ctx.stroke();

                // ข้อความค่า
                ctx.fillStyle = '#f3f4f6';
                ctx.font = '12px Noto Sans Thai';
                ctx.textAlign = 'center';
                ctx.fillText(value, x, y - 15);

                // ป้ายชื่อ
                ctx.fillStyle = '#9ca3af';
                ctx.fillText(data.labels[index], x, margin.top + chartHeight + 20);
            });

            // วาดเส้นเป้าหมาย
            ctx.strokeStyle = '#f59e0b';
            ctx.setLineDash([5, 5]);
            ctx.lineWidth = 2;
            const targetY = margin.top + chartHeight - (data.target / maxValue) * chartHeight;
            ctx.beginPath();
            ctx.moveTo(margin.left, targetY);
            ctx.lineTo(margin.left + chartWidth, targetY);
            ctx.stroke();
            ctx.setLineDash([]);

            // ข้อความเส้นเป้าหมาย
            ctx.fillStyle = '#f59e0b';
            ctx.font = '12px Noto Sans Thai';
            ctx.textAlign = 'left';
            ctx.fillText('Target: 73.07%', margin.left + 10, targetY - 10);

            // ชื่อกราฟ
            ctx.fillStyle = '#e5e7eb';
            ctx.font = 'bold 16px Noto Sans Thai';
            ctx.textAlign = 'center';
            ctx.fillText('กราฟเส้นแสดงแนวโน้ม EII', canvas.width / 2, 20);
        }

        // Validate EII Value
        function validateEIIValue(input) {
            const value = input.value;
            // Allow empty value during typing
            if (!value) return;

            // Remove non-numeric characters except decimal point
            let cleaned = value.replace(/[^\d.]/g, '');

            // Ensure only one decimal point
            const parts = cleaned.split('.');
            if (parts.length > 2) {
                cleaned = parts[0] + '.' + parts.slice(1).join('');
            }

            // Handle decimal places
            if (cleaned.includes('.')) {
                const [whole, decimal] = cleaned.split('.');
                // Limit whole number to 3 digits max
                const limitedWhole = whole.slice(0, 3);
                // Keep original decimal digits (up to 2)
                cleaned = `${limitedWhole}.${decimal.slice(0, 2)}`;
            }

            // Convert to number and validate range
            const num = parseFloat(cleaned);
            if (num > 100) {
                cleaned = '100.00';
            }

            // Update input value
            input.value = cleaned;
        }

        // Automatically set today's date for input type="date"
        function setTodayDate(inputId) {
            const dateInput = document.getElementById(inputId);
            if (dateInput) {
                const today = new Date();
                const year = today.getFullYear();
                const month = String(today.getMonth() + 1).padStart(2, '0');
                const day = String(today.getDate()).padStart(2, '0');
                dateInput.value = `${year}-${month}-${day}`;
            }
        }

        // Call the function for the relevant input fields
        setTodayDate('inputDate');

        // NEW: ฟังก์ชันสำหรับแสดง Toast Notification (ใช้ Tailwind CSS)
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');

            // Determine colors and icon based on type
            const baseClasses = "flex items-center w-full max-w-xs p-4 text-white rounded-lg shadow-xl transition-all transform duration-300 ease-out translate-x-0 opacity-100";
            let bgClass = '';
            let icon = '';

            if (type === 'success') {
                bgClass = 'bg-green-600';
                icon = `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>`;
            } else if (type === 'error') {
                bgClass = 'bg-red-600';
                icon = `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>`;
            }

            toast.className = `${baseClasses} ${bgClass}`;

            // Check if message is an array and format as a list
            let messageContent = '';
            if (Array.isArray(message)) {
                messageContent = '<ul class="list-disc pl-5">' + message.map(item => `<li>${item}</li>`).join('') + '</ul>';
            } else {
                messageContent = `<div class="text-sm font-normal">${message}</div>`;
            }

            toast.innerHTML = `
                <div class="inline-flex flex-shrink-0 justify-center items-center w-6 h-6 rounded-lg mr-3">
                    ${icon}
                </div>
                ${messageContent}
            `;

            container.prepend(toast); // Add new toast on top

            // Auto-hide the toast
            setTimeout(() => {
                toast.classList.remove('opacity-100');
                toast.classList.add('opacity-0');
                toast.classList.add('translate-x-full'); // Move off screen
                setTimeout(() => toast.remove(), 300); // Remove after transition
            }, 4000);
        }

        // วาดกราฟทั้งหมดเมื่อโหลดหน้า
        window.onload = function () {
            drawBarChart();
            drawPieChart();
            drawLineChart();

            // ตั้งค่าเริ่มต้นสำหรับฟอร์ม
            document.getElementById('inputDate').valueAsDate = new Date();
        };

        // อัพเดทกราฟเมื่อส่งฟอร์ม
        document.getElementById('eiiInputForm').addEventListener('submit', function (e) {
            e.preventDefault();

            // Validate form inputs
            const form = e.target;
            const inputs = form.querySelectorAll('input[type="text"]');
            const errors = [];

            inputs.forEach(input => {
                if (!input.value.trim()) {
                    errors.push(`${input.name} cannot be empty.`);
                } else if (!input.checkValidity()) {
                    errors.push(input.title || 'Invalid input');
                }
            });

            if (errors.length > 0) {
                showToast(errors, 'error');
                return;
            }

            // Show success toast
            showToast('ข้อมูลถูกส่งแล้ว! กราฟจะถูกอัพเดทด้วยข้อมูลใหม่', 'success');

            // Log form data to the console
            const formData = new FormData(form);
            for (const [key, value] of formData.entries()) {
                console.log(`${key}: ${value}`);
            }

            // Update charts with new data (simulation)
            drawBarChart();
            drawPieChart();
            drawLineChart();
        });
    </script>

    <!-- Toast Container (adjusted for bottom-right positioning) -->
    <div id="toastContainer"
        class="fixed bottom-4 right-4 flex flex-col-reverse items-end space-y-2 space-y-reverse pointer-events-none z-50">
        <!-- Toasts will be injected here by JavaScript -->
    </div>
</body>

</html>
